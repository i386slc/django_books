# 1.6 Настройка параметров для среды разработки, тестирования, промежуточной и производственной среды

Как отмечалось ранее, вы будете создавать новые функции в среде разработки, тестировать их в тестовой среде, а затем размещать веб-сайт на промежуточном сервере, чтобы другие люди могли опробовать новые функции. Затем веб-сайт будет развернут на рабочем сервере для общего доступа. Каждая из этих сред может иметь определенные настройки, и в этом рецепте вы узнаете, как их организовать.

## Подготовка

В проекте Django мы создадим настройки для каждой среды: разработки, тестирования, подготовки и производства.

## Как это сделать...

Выполните следующие действия, чтобы настроить параметры проекта:

1. В каталоге **myproject** создайте модуль **settings** Python со следующими файлами:

* `__init__.py` делает каталог настроек модулем Python.
* `_base.py` для общих настроек
* `dev.py` для настроек разработки
* `test.py` для тестирования настроек
* `staging.py` для промежуточных настроек
* `production.py` для производственных настроек

2\. Скопируйте содержимое `settings.py`, которое было автоматически создано при запуске нового проекта Django, в `settings/_base.py`. Затем удалите `settings.py`.

3\. Измените **BASE\_DIR** в `settings/_base.py`, чтобы он указывал на один уровень выше. Сначала он должен выглядеть следующим образом:

```python
BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
```

После изменения он должен выглядеть следующим образом:

```python
BASE_DIR = os.path.dirname(
    os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
)
```

4\. Если настройки окружения совпадают с общими настройками, то просто импортируйте туда все из `_base.py` следующим образом:

```python
# myproject/settings/production.py
from ._base import *
```

5\. Примените параметры, которые вы хотите прикрепить или перезаписать для конкретной среды, в других файлах — например, параметры среды разработки должны находиться в файле `dev.py`, как показано в следующем фрагменте кода:

```python
# myproject/settings/dev.py
from ._base import *
EMAIL_BACKEND = "django.core.mail.backends.console.EmailBackend"
```

6\. Измените файлы `manage.py` и `myproject/wsgi.py`, чтобы использовать один из параметров среды по умолчанию, изменив следующую строку:

```python
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'myproject.settings')
```

7\. Вы должны изменить эту строку на следующую:

```python
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'myproject.settings.production')
```

## Как это работает...

По умолчанию команды управления Django используют настройки из `myproject/settings.py`. Используя метод, определенный в этом рецепте, мы можем хранить все необходимые нечувствительные настройки для всех сред под контролем версий в каталоге **config**. С другой стороны, сам файл `settings.py` будет игнорироваться системой контроля версий и будет содержать только те параметры, которые необходимы для текущей среды разработки, тестирования, промежуточной или производственной среды.

{% hint style="info" %}
Для каждой среды рекомендуется устанавливать переменную среды **DJANGO\_SETTINGS\_MODULE** индивидуально, либо в настройках **PyCharm**, либо в сценарии `env/bin/activate`, либо в `.bash_profile`.
{% endhint %}

## Смотрите также

* Рецепт Работа с контейнерами Docker для Django, Gunicorn, Nginx и PostgreSQL
* Рецепт обработки конфиденциальных настроек
* Рецепт Определение относительных путей в настройках
* Рецепт создания файла игнорирования Git

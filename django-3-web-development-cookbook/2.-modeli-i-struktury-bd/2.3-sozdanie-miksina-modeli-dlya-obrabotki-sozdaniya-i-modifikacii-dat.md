# 2.3 Создание миксина модели для обработки создания и модификации дат

Обычно в модели включают временные метки для создания и модификации экземпляров модели. В этом рецепте вы узнаете, как создать простой миксин модели, который сохраняет даты и время создания и модификации вашей модели. Использование такого миксина гарантирует, что все модели используют одни и те же имена полей для меток времени и имеют одинаковое поведение.

## Подготовка

Если вы еще этого не сделали, создайте пакет **myproject.apps.core**, чтобы сохранить свои миксины. Затем создайте файл **models.py** в основном пакете **core**.

## Как это сделать...

Откройте файл **models.py** в вашем пакете **myprojects.apps.core** и вставьте туда следующее содержимое:

```python
# myproject/apps/core/models.py
from django.db import models
from django.utils.translation import gettext_lazy as _

class CreationModificationDateBase(models.Model):
    """
    Абстрактный базовый класс с датой и временем создания и изменения
    """

    created = models.DateTimeField(
        _("Creation Date and Time"),
        auto_now_add=True,
    )
    modified = models.DateTimeField(
        _("Modification Date and Time"),
        auto_now=True,
    )

    class Meta:
        abstract = True
```

## Как это работает...

Класс **CreationModificationDateMixin** является абстрактной моделью, что означает, что расширение классов модели создаст все поля в одной и той же таблице базы данных, т. е. не будет отношений один к одному, которые усложняют обработку таблицы.

Этот миксин имеет два поля даты и времени, **created** и **modified**. С атрибутами **auto\_now\_add** и **auto\_now** метки времени будут сохраняться автоматически при сохранении экземпляра модели. Поля автоматически получат атрибут `editable=False` и, таким образом, будут скрыты в административных формах. Если в настройках **USE\_TZ** установлено значение `True` (что является рекомендуемым значением по умолчанию), будут использоваться временные метки с учетом часового пояса. В противном случае будут использоваться временные метки без учета часового пояса. Отметки времени с учетом часового пояса сохраняются в часовом поясе всемирного координированного времени (**UTC**) в базе данных и преобразуются в часовой пояс проекта по умолчанию при их чтении или записи. Отметки времени без учета часового пояса сохраняются в базе данных в местном часовом поясе проекта; их вообще нецелесообразно использовать, потому что они усложняют управление временем между часовыми поясами.

Чтобы использовать этот миксин, нам просто нужно импортировать его и расширить нашу модель следующим образом:

```python
# myproject/apps/ideas/models.py
from django.db import models

from myproject.apps.core.models import CreationModificationDateBase

class Idea(CreationModificationDateBase):
    # другие поля, атрибуты, свойства и методы…
```

## Смотрите также

* Рецепт с [использованием модельных миксинов](2.1-ispolzovanie-miksinov-modeli.md)
* Рецепт «Создание модельного миксина для заботы о мета-тегах»
* Рецепт «Создание примеси модели для обработки общих отношений»
